iSQL> SELECT 100.00 * SUM( CASE2 ( SUBSTRING(P_TYPE, 1, 5) = 'PROMO', 
					         L_EXTENDEDPRICE * (1 - L_DISCOUNT), 
					         0 ) ) 
			    / SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS PROMO_REVENUE
FROM
	LINEITEM,
	PART
WHERE
	L_PARTKEY = P_PARTKEY
	AND L_SHIPDATE >= DATE'1995-09-01'
	AND L_SHIPDATE < ADD_MONTHS(DATE'1995-09-01', 1);
PROMO_REVENUE          
-------------------------
16.3807786263957       
1 row selected.
